# 클린 아키텍처

## 클린 아키텍처란?

- 클린 코드의 저자 로버트 C 마틴이 제안한 아키텍처
- 소프트웨어를 여러 개의 레이어로 나누고 각 레이어에 있는 컴포넌트는 안쪽 원에 있는 컴포넌트에만 의존성을 가지도록 한다. 따라서 안쪽 원에 존재하는 컴포넌트는 바깥 쪽에 독립적
    <img src="https://wikidocs.net/images/page/158675/1.png">

## 레이어 분류

- 레이어를 크게 4개로 분류 : 위 사진의 가장 바깥쪽부터 '인프라 스트럭처', '인터페이스', '애플리케이션', '도메인'
- 정해진 이름은 없음

### 인프라 스트럭처

- 인프라 레이어는 애플리케이션에 필요하지만 외부에서 가져와 쓰는 컴포넌트가 포함된다. ex) DB, 이메일 전송, 통신 프로토콜 구현체 등
- 외부에서 제공하는 인터페이스 혹은 라이브러리를 이용하여 서비스에 맞게 구현한 구현체가 인프라 스트럭처에 포함됨

### 인터페이스

- 서비스가 제공하는 인터페이스가 포함됨
- 컨트롤러가 외부에서 들어오는 요청은 어떤 형식이어야 하고 나가는 데이터는 어떠한지 제공하는 것처럼, 게이트웨이, 프레젠터와 같은 컴포넌트가 해당되며 외부와의 인터페이스를 담당하고 있다

### 애플리케이션

- 애플리케이션의 비즈니스 로직이 포함됨
- 회원 가입, 이메일 인증, 회원 정보 조회 등의 서비스들이 포함됨

### 도메인 레이어

- 애플리케이션의 핵심 도메인이 구현됨
- 도메인 레이어는 모든 레이어에 의존하지 않음
- 애플리케이션이 가져야 하는 핵심 요소만 가짐
- 도메인 레이어의 컴포넌트 변경 시 이를 사용하는 모든 레이어를 수정해야 하므로 신중히 작성해야 함

## 의존성 역전 원칙(DIP)

- 각 레이어는 의존성이 안쪽 원으로 향해야하지만 구현을 위해 안쪽 레어어에서 바깥쪽 레이어의 구현체가 필요한 경우가 있음, 이때 해당 구현체를 직접 의존하게 되면 구현체가 변경될 경우 함께 수정해야 하므로 독립적이지 않음. 특히 인프라 레이어의 DB같은 경우 MySQL -> PostgreSQL로 변경하는 등 다른 것으로 변경하는 경우가 종종 발생하기 때문에 이렇게 의존 성이 역전되는 경우를 위해 안쪽 레이어에서는 그 레이어 내에서 인터페이스를 정의하고, 인터페이스를 구현한 구현체를 바깥 레이어에 둔다면 의존성이 역전되지 않도록 할 수 있다.
